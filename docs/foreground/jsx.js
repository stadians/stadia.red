const renderChild = content => {
  if (content === null || content === undefined) {
    return document.createElement("span");
  } else if (content instanceof Node) {
    return content;
  } else if (
    typeof content === "string" ||
    typeof content === "number" ||
    typeof content === "boolean"
  ) {
    return document.createTextNode(String(content));
  } else {
    const container = document.createDocumentFragment();
    for (const child of content) {
      container.appendChild(renderChild(child));
    }
    return container;
  }
};
const componentsByName = new Map();
const namesByComponent = new Map();
export const createElement = (type, props, ...children) => {
  const nativeProps = { ...(props || {}) };
  const style = nativeProps.style;
  delete nativeProps.style;
  let el;
  if (typeof type === "string") {
    el = document.createElement(type);
    Object.assign(el, nativeProps);
    el.appendChild(renderChild(children));
  } else {
    let name = namesByComponent.get(type);
    if (!name) {
      const ownName = type.name || "_";
      let count = 1;
      name = ownName;
      while (componentsByName.has(name)) {
        count += 1;
        name = ownName + count;
      }
      if (type.name && count > 1) {
        console.warn(
          `Multiple (${count}) components named ${type.name} in use.`,
        );
      }
      componentsByName.set(name, type);
      namesByComponent.set(type, name);
      if (type.style) {
        const el = document.querySelector("style");
        const sheet = el.sheet;
        const i = sheet.insertRule(
          `body .${name}.Component {}`,
          sheet.rules.length,
        );
        Object.assign(sheet.rules[i].style, type.style);
        // HACK: these changes will work but will be confusingly invisible in the DOM so we write them back:
        el.textContent = Array.from(sheet.rules)
          .map(r => r.cssText)
          .join("\n");
      }
    }
    el = type(Object.assign(nativeProps, { children }));
    if (type.name) {
      el.classList.add(name, "Component");
    }
  }
  if (style) {
    Object.assign(el.style, style);
  }
  return el;
};
export const fragment = (...fragments) => {
  if (fragments.length === 1) {
    return fragments[0];
  }
  const result = document.createDocumentFragment();
  for (const fragment of fragments) {
    result.appendChild(fragment);
  }
  return result;
};
Object.assign(window, {
  JSX: {
    createElement,
  },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianN4LmpzIiwic291cmNlUm9vdCI6Ii4vIiwic291cmNlcyI6WyJmb3JlZ3JvdW5kL2pzeC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxNQUFNLFdBQVcsR0FBRyxDQUFDLE9BQW1CLEVBQVEsRUFBRTtJQUNoRCxJQUFJLE9BQU8sS0FBSyxJQUFJLElBQUksT0FBTyxLQUFLLFNBQVMsRUFBRTtRQUM3QyxPQUFPLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDdkM7U0FBTSxJQUFJLE9BQU8sWUFBWSxJQUFJLEVBQUU7UUFDbEMsT0FBTyxPQUFPLENBQUM7S0FDaEI7U0FBTSxJQUNMLE9BQU8sT0FBTyxLQUFLLFFBQVE7UUFDM0IsT0FBTyxPQUFPLEtBQUssUUFBUTtRQUMzQixPQUFPLE9BQU8sS0FBSyxTQUFTLEVBQzVCO1FBQ0EsT0FBTyxRQUFRLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0tBQ2pEO1NBQU07UUFDTCxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztRQUNwRCxLQUFLLE1BQU0sS0FBSyxJQUFJLE9BQU8sRUFBRTtZQUMzQixTQUFTLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1NBQzNDO1FBQ0QsT0FBTyxTQUFTLENBQUM7S0FDbEI7QUFDSCxDQUFDLENBQUM7QUFFRixNQUFNLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7QUFDbkMsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDO0FBQ25DLE1BQU0sQ0FBQyxNQUFNLGFBQWEsR0FBRyxDQUMzQixJQUF3QixFQUN4QixLQUFZLEVBQ1osR0FBRyxRQUEyQixFQUNqQixFQUFFO0lBQ2YsTUFBTSxXQUFXLEdBQUcsRUFBRSxHQUFHLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUM7SUFDekMsTUFBTSxLQUFLLEdBQUcs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QyxzQkFBc0IsRUFBRSxDQUFDO0lBQ2pELEtBQUssTUFBTSxRQUFRLElBQUksU0FBUyxFQUFFO1FBQ2hDLE1BQU0sQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7S0FDOUI7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTtJQUNwQixHQUFHLEVBQUU7UUFDSCxhQUFhO0tBQ2Q7Q0FDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBSZW5kZXJhYmxlID0gSlNYLlJlbmRlcmFibGU7XG5leHBvcnQgdHlwZSBGQzxQcm9wcz4gPSBKU1guRkM8UHJvcHM+O1xuXG5jb25zdCByZW5kZXJDaGlsZCA9IChjb250ZW50OiBSZW5kZXJhYmxlKTogTm9kZSA9PiB7XG4gIGlmIChjb250ZW50ID09PSBudWxsIHx8IGNvbnRlbnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgfSBlbHNlIGlmIChjb250ZW50IGluc3RhbmNlb2YgTm9kZSkge1xuICAgIHJldHVybiBjb250ZW50O1xuICB9IGVsc2UgaWYgKFxuICAgIHR5cGVvZiBjb250ZW50ID09PSBcInN0cmluZ1wiIHx8XG4gICAgdHlwZW9mIGNvbnRlbnQgPT09IFwibnVtYmVyXCIgfHxcbiAgICB0eXBlb2YgY29udGVudCA9PT0gXCJib29sZWFuXCJcbiAgKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFN0cmluZyhjb250ZW50KSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY29udGVudCkge1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHJlbmRlckNoaWxkKGNoaWxkKSk7XG4gICAgfVxuICAgIHJldHVybiBjb250YWluZXI7XG4gIH1cbn07XG5cbmNvbnN0IGNvbXBvbmVudHNCeU5hbWUgPSBuZXcgTWFwKCk7XG5jb25zdCBuYW1lc0J5Q29tcG9uZW50ID0gbmV3IE1hcCgpO1xuZXhwb3J0IGNvbnN0IGNyZWF0ZUVsZW1lbnQgPSA8UHJvcHMgZXh0ZW5kcyB7fSA9IHt9PihcbiAgdHlwZTogc3RyaW5nIHwgRkM8UHJvcHM+LFxuICBwcm9wczogUHJvcHMsXG4gIC4uLmNoaWxkcmVuOiBBcnJheTxSZW5kZXJhYmxlPlxuKTogSFRNTEVsZW1lbnQgPT4ge1xuICBjb25zdCBuYXRpdmVQcm9wcyA9IHsgLi4uKHByb3BzIHx8IHt9KSB9O1xuICBjb25zdCBzdHlsZSA9IG5hdGl2ZVByb3BzLnN0eWxlO1xuICBkZWxldGUgbmF0aXZlUHJvcHMuc3R5bGU7XG5cbiAgbGV0IGVsOiBIVE1MRWxlbWVudDtcbiAgaWYgKHR5cGVvZiB0eXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHR5cGUpO1xuICAgIE9iamVjdC5hc3NpZ24oZWwsIG5hdGl2ZVByb3BzKTtcbiAgICBlbC5hcHBlbmRDaGlsZChyZW5kZXJDaGlsZChjaGlsZHJlbikpO1xuICB9IGVsc2Uge1xuICAgIGxldCBuYW1lID0gbmFtZXNCeUNvbXBvbmVudC5nZXQodHlwZSk7XG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICBjb25zdCBvd25OYW1lID0gdHlwZS5uYW1lIHx8IFwiX1wiO1xuICAgICAgbGV0IGNvdW50ID0gMTtcbiAgICAgIG5hbWUgPSBvd25OYW1lO1xuXG4gICAgICB3aGlsZSAoY29tcG9uZW50c0J5TmFtZS5oYXMobmFtZSkpIHtcbiAgICAgICAgY291bnQgKz0gMTtcbiAgICAgICAgbmFtZSA9IG93bk5hbWUgKyBjb3VudDtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGUubmFtZSAmJiBjb3VudCA+IDEpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGBNdWx0aXBsZSAoJHtjb3VudH0pIGNvbXBvbmVudHMgbmFtZWQgJHt0eXBlLm5hbWV9IGluIHVzZS5gLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb21wb25lbnRzQnlOYW1lLnNldChuYW1lLCB0eXBlKTtcbiAgICAgIG5hbWVzQnlDb21wb25lbnQuc2V0KHR5cGUsIG5hbWUpO1xuXG4gICAgICBpZiAodHlwZS5zdHlsZSkge1xuICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJzdHlsZVwiKSE7XG4gICAgICAgIGNvbnN0IHNoZWV0OiBDU1NTdHlsZVNoZWV0ID0gZWwuc2hlZXQgYXMgYW55O1xuICAgICAgICBjb25zdCBpID0gc2hlZXQuaW5zZXJ0UnVsZShcbiAgICAgICAgICBgYm9keSAuJHtuYW1lfS5Db21wb25lbnQge31gLFxuICAgICAgICAgIHNoZWV0LnJ1bGVzLmxlbmd0aCxcbiAgICAgICAgKTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihzaGVldC5ydWxlc1tpXS5zdHlsZSwgdHlwZS5zdHlsZSk7XG4gICAgICAgIC8vIEhBQ0s6IHRoZXNlIGNoYW5nZXMgd2lsbCB3b3JrIGJ1dCB3aWxsIGJlIGNvbmZ1c2luZ2x5IGludmlzaWJsZSBpbiB0aGUgRE9NIHNvIHdlIHdyaXRlIHRoZW0gYmFjazpcbiAgICAgICAgZWwudGV4dENvbnRlbnQgPSBBcnJheS5mcm9tKHNoZWV0LnJ1bGVzKVxuICAgICAgICAgIC5tYXAociA9PiByLmNzc1RleHQpXG4gICAgICAgICAgLmpvaW4oXCJcXG5cIik7XG4gICAgICB9XG4gICAgfVxuICAgIGVsID0gdHlwZShPYmplY3QuYXNzaWduKG5hdGl2ZVByb3BzLCB7IGNoaWxkcmVuIH0pKTtcbiAgICBpZiAodHlwZS5uYW1lKSB7XG4gICAgICBlbC5jbGFzc0xpc3QuYWRkKG5hbWUsIFwiQ29tcG9uZW50XCIpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChzdHlsZSkge1xuICAgIE9iamVjdC5hc3NpZ24oZWwuc3R5bGUsIHN0eWxlKTtcbiAgfVxuXG4gIHJldHVybiBlbDtcbn07XG5cbmV4cG9ydCBjb25zdCBmcmFnbWVudCA9IChcbiAgLi4uZnJhZ21lbnRzOiBBcnJheTxEb2N1bWVudEZyYWdtZW50IHwgRWxlbWVudD5cbik6IERvY3VtZW50RnJhZ21lbnQgfCBFbGVtZW50ID0+IHtcbiAgaWYgKGZyYWdtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICByZXR1cm4gZnJhZ21lbnRzWzBdO1xuICB9XG4gIGNvbnN0IHJlc3VsdCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgZm9yIChjb25zdCBmcmFnbWVudCBvZiBmcmFnbWVudHMpIHtcbiAgICByZXN1bHQuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5PYmplY3QuYXNzaWduKHdpbmRvdywge1xuICBKU1g6IHtcbiAgICBjcmVhdGVFbGVtZW50LFxuICB9LFxufSk7XG4iXX0=
